class InfiniteTimeProgressBar{constructor(options={}){this.canRender=!1;this.options={selector:".infinite-time-progress-bar",duration:5000,callback:()=>{},...options,};if(this.validate()){this.options.duration=this.options.duration<1000?2000:this.options.duration;this.options.duration=Math.abs(this.options.duration)/1000;try{this.loadElements();this.calculate()}catch(error){this.canRender=!1;console.error(error);return!1}}}
validate=()=>{const{selector,duration,callback}=this.options;if(typeof selector!=="string"){showError("Type of selector must be string");return!1}
if(typeof duration!=="number"){showError("Type of duration must be number");return!1}
if(typeof callback!=="function"){showError("Type of callback must be function");return!1}
function showError(message){console.error(message)}
return!0};loadElements=()=>{const{selector,duration}=this.options;this.container=document.querySelector(selector);this.circle=this.container.querySelector("svg circle");this.remainingTimeContainer=this.container.querySelector("p");this.canRender=!0};calculate=()=>{const{duration}=this.options;this.progress=100;this.incrementEverySecond=100/Math.round(duration);this.radius=this.circle.r.baseVal.value;this.circumference=this.radius*2*Math.PI;this.circle.style.strokeDasharray=`${this.circumference} ${this.circumference}`;this.incrementEverySecond=this.progress/Math.round(Math.floor(duration));this.setSecond(duration)};hideProgressBar=()=>{this.container.classList.remove("show");this.container.classList.add("fade")};visibleProgressBar=()=>{this.container.classList.remove("fade","hide");this.container.classList.add("show")};setSecond=(duration)=>{this.remainingTimeContainer.innerText=duration};setProgress=(percent)=>{this.circle.style.strokeDashoffset=this.circumference-(percent/100)*this.circumference};render=()=>{if(this.canRender){let{progress}=this,{duration,callback}=this.options;this.visibleProgressBar();duration=duration+1;const timer=setInterval(()=>{duration=duration-1;progress=progress-this.incrementEverySecond;this.setSecond(duration);this.setProgress(progress);if(duration<2){clearInterval(timer);this.hideProgressBar();callback();return}},1000);return!0}
return!1}}